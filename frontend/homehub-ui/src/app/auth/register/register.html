<section id="register" class="form-section">
  <div class="container">
    <div class="section-header">
      <h2 class="gradient-text">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
      <p>–°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ –∞–∫–∞—É–Ω—Ç –∑–∞ –¥–æ—Å—Ç—ä–ø –¥–æ –Ω–∞—à–∏—Ç–µ —É—Å–ª—É–≥–∏</p>
    </div>
    <div class="form-container">

      <!-- Error Message -->
      <div class="error-message show" *ngIf="showError">
          <div class="error-content">
              <span class="error-icon">‚ö†Ô∏è</span>
              <span class="error-text">{{ errorMessage }}</span>
              <button class="error-close" (click)="closeError()" type="button">‚úï</button>
          </div>
      </div>

      <form class="auth-form" [formGroup]="registerForm" (ngSubmit)="onSubmit()">

        <div class="form-row">
          <div class="form-group">
            <label for="register-firstName">–ü—ä—Ä–≤–æ –∏–º–µ</label>
            <input type="text" id="register-firstName" formControlName="firstName"
              [class.error]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
            <div *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched" class="validator-error-message">
              <small *ngIf="registerForm.get('firstName')?.errors?.['required']">–ü—ä—Ä–≤–æ—Ç–æ –∏–º–µ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ.</small>
              <small *ngIf="registerForm.get('firstName')?.errors?.['minlength']">–ü—ä—Ä–≤–æ—Ç–æ –∏–º–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –ø–æ–Ω–µ 3 —Å–∏–º–≤–æ–ª–∞.</small>
              <small *ngIf="registerForm.get('firstName')?.errors?.['maxlength']">–ü—ä—Ä–≤–æ—Ç–æ –∏–º–µ –Ω–µ –º–æ–∂–µ –¥–∞ –µ –ø–æ-–¥—ä–ª–≥–æ –æ—Ç 64 —Å–∏–º–≤–æ–ª–∞.</small>
            </div>
          </div>
          <div class="form-group">
            <label for="register-lastName">–§–∞–º–∏–ª–∏—è</label>
            <input type="text" id="register-lastName" formControlName="lastName"
              [class.error]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
            <div *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched" class="validator-error-message">
              <small *ngIf="registerForm.get('lastName')?.errors?.['required']">–§–∞–º–∏–ª–∏—è—Ç–∞ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞.</small>
              <small *ngIf="registerForm.get('lastName')?.errors?.['minlength']">–§–∞–º–∏–ª–∏—è—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –ø–æ–Ω–µ 3 —Å–∏–º–≤–æ–ª–∞.</small>
              <small *ngIf="registerForm.get('lastName')?.errors?.['maxlength']">–§–∞–º–∏–ª–∏—è—Ç–∞ –Ω–µ –º–æ–∂–µ –¥–∞ –µ –ø–æ-–¥—ä–ª–≥–∞ –æ—Ç 64 —Å–∏–º–≤–æ–ª–∞.</small>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="register-password">–ü–∞—Ä–æ–ª–∞</label>
            <input type="password" id="register-password" formControlName="password"
              [class.error]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
              (input)="checkPasswordMatch()">
            <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" class="validator-error-message">
              <small *ngIf="registerForm.get('password')?.errors?.['required']">–ü–∞—Ä–æ–ª–∞—Ç–∞ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞.</small>
              <small *ngIf="registerForm.get('password')?.errors?.['minlength']">–ü–∞—Ä–æ–ª–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –ø–æ–Ω–µ 4 —Å–∏–º–≤–æ–ª–∞.</small>
              <small *ngIf="registerForm.get('password')?.errors?.['maxlength']">–ü–∞—Ä–æ–ª–∞—Ç–∞ –Ω–µ –º–æ–∂–µ –¥–∞ –µ –ø–æ-–¥—ä–ª–≥–∞ –æ—Ç 16 —Å–∏–º–≤–æ–ª–∞.</small>
            </div>
          </div>
          <div class="form-group">
            <label for="register-confirm">–ü–æ–≤—Ç–æ—Ä–∏ –ø–∞—Ä–æ–ª–∞</label>
            <input type="password" id="register-confirm" formControlName="confirmPassword"
              [class.error]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched"
              [class.success]="passwordsMatch && registerForm.get('confirmPassword')?.value"
              (input)="checkPasswordMatch()">
            <div *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched" class="validator-error-message">
              <small *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">–ü–æ–≤—Ç–æ—Ä–µ—Ç–µ –ø–∞—Ä–æ–ª–∞—Ç–∞ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞.</small>
              <small *ngIf="registerForm.get('confirmPassword')?.errors?.['minlength']">–ü–æ–≤—Ç–æ—Ä–µ—Ç–µ –ø–∞—Ä–æ–ª–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –ø–æ–Ω–µ 4 —Å–∏–º–≤–æ–ª–∞.</small>
              <small *ngIf="registerForm.get('confirmPassword')?.errors?.['maxlength']">–ü–æ–≤—Ç–æ—Ä–µ—Ç–µ –ø–∞—Ä–æ–ª–∞—Ç–∞ –Ω–µ –º–æ–∂–µ –¥–∞ –µ –ø–æ-–¥—ä–ª–≥–∞ –æ—Ç 16 —Å–∏–º–≤–æ–ª–∞.</small>
              <small *ngIf="!passwordsMatch && registerForm.get('confirmPassword')?.touched">–ü–∞—Ä–æ–ª–∏—Ç–µ –Ω–µ —Å—ä–≤–ø–∞–¥–∞—Ç.</small>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="register-email">–ò–º–µ–π–ª –∞–¥—Ä–µ—Å</label>
            <input type="email" id="register-email" formControlName="email"
              [class.error]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="validator-error-message">
              <small *ngIf="registerForm.get('email')?.errors?.['required']">–ò–º–µ–π–ª –∞–¥—Ä–µ—Å—ä—Ç –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω.</small>
              <small *ngIf="registerForm.get('email')?.errors?.['email']">–ù–µ–≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª —Ñ–æ—Ä–º–∞—Ç.</small>
            </div>
          </div>
          <div class="form-group">
            <label for="register-familyRole">–†–æ–ª—è –≤ —Å–µ–º–µ–π—Å—Ç–≤–æ—Ç–æ</label>
            <input type="text" id="register-familyRole" formControlName="familyRole"
              [class.error]="registerForm.get('familyRole')?.invalid && registerForm.get('familyRole')?.touched">
            <div *ngIf="registerForm.get('familyRole')?.invalid && registerForm.get('familyRole')?.touched" class="validator-error-message">
              <small *ngIf="registerForm.get('familyRole')?.errors?.['required']">–†–æ–ª—è—Ç–∞ –≤ —Å–µ–º–µ–π—Å—Ç–≤–æ—Ç–æ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞.</small>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="register-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
          <textarea id="register-description" formControlName="description"rows="3"
            [class.error]="registerForm.get('description')?.invalid && registerForm.get('description')?.touched">
          </textarea>
          <div *ngIf="registerForm.get('description')?.invalid && registerForm.get('description')?.touched" class="validator-error-message">
            <small *ngIf="registerForm.get('description')?.errors?.['required']">–û–ø–∏—Å–∞–Ω–∏–µ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ.</small>
            <small *ngIf="registerForm.get('description')?.errors?.['minlength']">–û–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –ø–æ–Ω–µ 10 —Å–∏–º–≤–æ–ª–∞.</small>
            <small *ngIf="registerForm.get('description')?.errors?.['maxlength']">–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –º–æ–∂–µ –¥–∞ –µ –ø–æ-–¥—ä–ª–≥–æ –æ—Ç 256 —Å–∏–º–≤–æ–ª–∞.</small>
          </div>
        </div>

        <div class="form-group">
          <label for="profile-image">–ü—Ä–æ—Ñ–∏–ª–Ω–∞ —Å–Ω–∏–º–∫–∞</label>
          <div class="file-upload">
            <input type="file" id="profile-image" accept="image/*"(change)="onFileChange($event)">
            <label for="profile-image" class="file-label" [class.has-file]="fileName">
              <span class="upload-icon">üì∑</span>
              <span class="upload-text">{{ fileName || '–ò–∑–±–µ—Ä–∏ —Å–Ω–∏–º–∫–∞' }}</span>
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="register-familyId">–°–µ–º–µ–π—Å—Ç–≤–æ</label>
          <input type="text" id="register-familyId" formControlName="familyId"
            [class.error]="registerForm.get('familyId')?.invalid && registerForm.get('familyId')?.touched">
          <div *ngIf="registerForm.get('familyId')?.invalid && registerForm.get('familyId')?.touched" class="validator-error-message">
            <small *ngIf="registerForm.get('familyId')?.errors?.['required']">–°–µ–º–µ–π—Å—Ç–≤–æ—Ç–æ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ.</small>
          </div>
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" formControlName="terms">
            <span class="checkmark"></span>
            –°—ä–≥–ª–∞—Å–µ–Ω —Å—ä–º —Å <a href="#" class="link" (click)="$event.preventDefault()">—É—Å–ª–æ–≤–∏—è—Ç–∞ –∑–∞ –ø–æ–ª–∑–≤–∞–Ω–µ</a>
          </label>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary" [disabled]="isLoading">
            {{ buttonText }}
          </button>
        </div>
      </form>
    </div>
  </div>
</section>
